\documentclass[12pt]{article}

% Author's up-front packages
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}

% Packages on template
\usepackage{amsmath, mathtools}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{colortbl}
\usepackage{xr}
\usepackage{hyperref}
\usepackage{longtable}
\usepackage{xfrac}
\usepackage{tabularx}
\usepackage{float}
\usepackage{siunitx}
\usepackage{booktabs}
\usepackage{caption}
\usepackage{pdflscape}
\usepackage{afterpage}

% ---- Author's choice to remove them ----
%\usepackage[round]{natbib}
%\usepackage{refcheck}

% Author's packages
\usepackage{cite}
\usepackage{indentfirst}
\usepackage{cleveref}
\usepackage{float}
%\usepackage{amsthm}

\hypersetup{
    %bookmarks=true,         % show bookmarks bar?
    colorlinks=true,       % false: boxed links; true: colored links
    linkcolor=red,          % color of internal links (change box color with 
%linkbordercolor)
    citecolor=green,        % color of links to bibliography
    filecolor=magenta,      % color of file links
    urlcolor=blue           % color of external links
}

\input{../Comments}

% For easy change of table widths
\newcommand{\colZwidth}{1.0\textwidth}
\newcommand{\colAwidth}{0.13\textwidth}
\newcommand{\colBwidth}{0.82\textwidth}
\newcommand{\colCwidth}{0.1\textwidth}
\newcommand{\colDwidth}{0.05\textwidth}
\newcommand{\colEwidth}{0.8\textwidth}
\newcommand{\colFwidth}{0.17\textwidth}
\newcommand{\colGwidth}{0.5\textwidth}
\newcommand{\colHwidth}{0.28\textwidth}


% Used so that cross-references have a meaningful prefix
\newcommand{\progname}{STEM Moir{\'e} GPA}

\usepackage{fullpage}

%Set the custom referencing system
\newtheorem{GS}{GS}
\crefname{GS}{GS}{GSs}
\newtheorem{A}{A}
\crefname{A}{A}{As}

\begin{document}

\title{Software Requirements Specifications (SRS) \\
STEM Moir{\'e} GPA} 
\author{Alexandre Pofelski \\
		macid: pofelska \\
		github: slimpotatoes}
\date{\today}
	
\maketitle

\pagenumbering{roman}
\tableofcontents

\begin{table}[bp]
\caption{\bf Revision History}
\begin{tabularx}{\textwidth}{p{3cm}p{2cm}X}
\toprule {\bf Date} & {\bf Version} & {\bf Notes}\\
\midrule
19/09/2017 & 1.0 & First Draft\\
\bottomrule
\end{tabularx}
\end{table}

\clearpage

\section{Reference Material}

\subsection{Table of Units}

Throughout this document SI 
(\href{<https://physics.nist.gov/cuu/Units/index.html>}{Syst\`{e}me 
Internationale d'Unit\'{e}s}) is employed as the unit system. In addition to the 
basic units, several derived units are used as described below.  For each unit, 
the symbol is given followed by a description of the unit and the SI name.\par 
\bigskip

\renewcommand{\arraystretch}{1.2}
%\begin{table}[ht]
  \noindent \begin{tabular}{l l l} 
    \toprule		
    \textbf{Symbol} & \textbf{Base quantity} & \textbf{Name SI}\\
    \midrule 
    \si{\metre} & length & metre\\
    \si{\per\metre} & reciprocal meter & wave number\\
    \si{\second} & time & second\\
    \bottomrule
  \end{tabular}
  %	\caption{Provide a caption}
%\end{table}

\wss{Only include the units that your SRS actually uses}

\subsection{Table of Symbols}

The table that follows summarizes the symbols used in this document along with
their units.  The symbols are listed in alphabetical order.

\renewcommand{\arraystretch}{1.2}
%\noindent \begin{tabularx}{1.0\textwidth}{l l X}
\noindent \begin{longtable*}{l l p{12cm}} \toprule
\textbf{Symbol} & \textbf{Unit} & \textbf{Description}\\
\midrule 
$A_C$ & \si[per-mode=symbol] {\square\metre} & coil surface area
\\
$A_\text{in}$ & \si[per-mode=symbol] {\square\metre} & surface area over 
which heat is transferred in
\\ 
\bottomrule
\end{longtable*}
\wss{Use your problems actual symbols.  The si package is a good idea to use for
  units.}

\subsection{Abbreviations and Acronyms}

\renewcommand{\arraystretch}{1.2}
\begin{tabular}{l l} 
  \toprule		
  \textbf{symbol} & \textbf{description}\\
  \midrule 
  A & Assumption\\
  DD & Data Definition\\
  EM & Electron Micrograph \\
  GD & General Definition\\
  GPA & Geometrical Phase Analysis \\
  GS & Goal Statement\\
  IM & Instance Model\\
  LC & Likely Change\\
  PS & Physical System Description\\
  R & Requirement\\
  SMH & STEM Moir{\'e} Hologram \\
  SRS & Software Requirements Specification\\
  STEM & Scanning Transmission Electron Microscopy \\
  \progname{} & \wss{put your program name here}\\
  T & Theoretical Model\\
  \bottomrule
\end{tabular}\\

\wss{Add any other abbreviations or acronyms that you add}

\newpage
\pagenumbering{arabic}

\section{Introduction}

\wss{This SRS template is based on \citet{SmithAndLai2005, SmithEtAl2007}.  It
  will get you started, but you will have to make changes.  Any changes to
  section headings should be approved by the instructor, since that implies a
  deviation from the template.  Although the bits shown below do not include
  type information, you may need to add this information for your problem.}

\wss{Feel free to change the appearance of the report by modifying the LaTeX
  commands.}

\wss{If you are documenting a family of models, you can start from this same
  template, but you will have to add a section for variabilities.  For program
  families you should look at \cite{Smith2006, SmithMcCutchanAndCarette2017}.
  You should be able to do one document that captures the commonality analysis
  and the requirements.}

\subsection{Purpose of Document}

\subsection{Scope of Requirements} 

\subsection{Characteristics of Intended Reader} 

\subsection{Organization of Document}

\section{General System Description}

This section identifies the interfaces between the system and its environment,
describes the user characteristics and lists the system constraints.

\subsection{System Context}

\wss{Your system context will likely include an explicit list of user and system
  responsibilities}

\begin{itemize}
\item User Responsibilities:
\begin{itemize}
\item 
\end{itemize}
\item \progname{} Responsibilities:
\begin{itemize}
\item Detect data type mismatch, such as a string of characters instead of a
  floating point number
\item 
\end{itemize}
\end{itemize}

\subsection{User Characteristics} \label{SecUserCharacteristics}

The end user of \progname{} should have an understanding of undergraduate Level
1 Calculus and Physics.

\subsection{System Constraints}

\wss{You may not have any system constraints}

\section{Specific System Description}
\subsection{Problem Description} \label{Sec_pd}

STEM Moir{\'e} GPA project is software capable of converting a STEM Moir{\'e} 
hologram into 2D strain maps.

\subsubsection{Terminology and Definitions}

Regarding the complexity of the electron/matter interaction, some crude 
simplifications are proposed to describe the terminologies below. While 
sometimes not realistic, the simplifications are here to help in visualizing the 
context and the type of data the STEM Moir{\'e} GPA software is subjected to. Nevertheless, 
all the simplifications are not affecting the definition of the concept used at 
the software level.

\begin{itemize}

\item \textbf{2D Cartesian coordinate system}: orthonormal coordinate system model by the orthonormal base $\mathcal{B}=(O,\vec{u_x},\vec{u_y}$ such that any vector $\vec{r}$ can be expressed as the following with $\mathbb{R}$ representing the set of real space:
\begin{equation}
\forall (x,y) \in \mathbb{R}^{2}, \vec{r}=x\vec{u_x}+y\vec{u_y}
\end{equation}
\item \textbf{Pixel}: smallest addressable element sampling a 2D continuum.
\item \textbf{Electron Micrograph (EM)}: 2D array collected in an electron microscope 
representing the number of electron crossing the sample (intensity) at each 
pixel location.
\item \textbf{Scanning grid}: set representing the succession of the STEM probe positions when collecting the STEM EM. Equivalently the scanning grid represents the relative position of the pixel with respect to the sample when acquiring the EM. A simplified version of the 
STEM EM formation can be visualized in \cref{fig:STEM_imaging_Fig}. The positions of the STEM probe are located at the intersection of the black grid lines.
\begin{figure}[H]
\includegraphics[width=\linewidth]{Figures/STEM_imaging_Fig.png}
\caption{On the left hand side, a schematic of the STEM EM formation with the STEM probe scanning the sample at each intersection of the grid lines. The electrons crossing the sample are collected on the detector and counted during the acquisition time. On the right hand side is presented a STEM EM on a pure silicon sample revealing its atomic structure. In the inset is highlighted the type of data the STEM EM corresponds to which is a 2D array.}
\label{fig:STEM_imaging_Fig}
\end{figure}
In the 2D Cartesian coordinate system, the scanning grid can be seen as sampler $S$ of continuous function $f$. For the purpose of the STEM Moir{\'e} GPA, the sampler is set to be periodic with the same periodicity $p$ (called pixel size) in both $x$ and $y$ directions (2D Dirac comb). The resulting sampled version $f_S$ of $f$ can be represented as the following with $\delta$ representing the Dirac functio
\begin{equation}
\begin{gathered}
\forall (x,y) \in \mathbb{R}^{2}, f_S(x,y)=S(x,y)\times f(x,y) \\
\forall (x,y) \in \mathbb{R}^{2}, f_S(x,y)=\sum_{n=-\infty}^{n=+\infty}\sum_{m=-\infty}^{m=+\infty}\delta(x-np,y-mp)\times f(x,y)
\end{gathered}
\label{eq:sampling}
\end{equation}
For shorter notations, it is position to define a set Q as follows $Q=\{\forall (n,m) \in \mathbb{Z}^{2}, \vec{q}=n\vec{u_x}+m\vec{u_y}\}$ with $\mathbb{Z}$ representing the set of integer numbers and thus simplify \cref{eq:sampling}
\begin{equation}
\forall (x,y) \in \mathbb{R}^{2}, f_S(\vec{r})=\sum_{q\in Q}\delta(\vec{r}-p\vec{q}) f(\vec{r})
\label{eq:sampling_simplified}
\end{equation}
\item \textbf{Hologram}: Result from an interference between two or multiples waves. \newline
Let consider two monochromatic plane waves $\psi_1$ and $\psi_2$ with their respective amplitude $A_j$, phase $\phi_j$ and wave vector $\vec{k_j}$ in the 2D Cartesian system. The hologram $\psi_H$ and the resulting intensity from the hologram $I_H$ can be modelled as follows with $i$ representing the imaginary unit:
\begin{equation}
\begin{gathered}
\forall (x,y) \in \mathbb{R}^{2},\psi_H(\vec{r})=\psi_1+\psi_2= A_1e^{i(\vec{k_1}\cdot\vec{r})+i\phi_1}+A_2e^{i(\vec{k_2}\cdot\vec{r})+i\phi_2} \\
\forall (x,y) \in \mathbb{R}^{2},I_H(\vec{r})=\psi_H\psi_H^{*}= A_{1}^{2}+A_{2}^{2}+A_{1}A_{1}(e^{i(\vec{k_1}-\vec{k_2})\cdot\vec{r}+i(\phi_1-\phi_2)}+e^{i(\vec{k_2}-\vec{k_1})\cdot\vec{r}+i(\phi_2-\phi_1)})
\end{gathered}
\label{eq:hologram}
\end{equation}
The more waves are contributing to the hologram, the more complex \cref{eq:hologram} will be. However, similar factors will appear with constants and cross product terms. 
\item \textbf{Moir{\'e} hologram}: Result from interference between two or multiple waves with similar but not equal wave numbers (or wave vectors in 2D). \an{Don't like the terminology similar}
\item \textbf{Crystal lattice}: Arrangement of atoms forming matter.\newline
For the purpose of the STEM Moir{\'e} GPA, only mono-crystalline samples are analysed.\an{Think about that ... limit it to mono-crystalline samples is obvious for me but is it possible to see more general case ?} In the case of a perfect periodic atomic arrangement, the crystalline lattice $I_c$ can be described in Fourier series with $C_j$ the complex Fourier coefficient related to the crystalline wave vector $\vec{g_j}$ in the 2D Cartesian system.
\begin{equation}
\forall (x,y) \in \mathbb{R}^{2},I_C(\vec{r})=\sum_{j=-\infty}^{j=+\infty}C_je^{i(\vec{g_j}\cdot\vec{r})}
\label{eq:crystal_Fourier_series}
\end{equation}
If the crystal is elastically deformed, the relative position of the atoms will be slightly modified from their original unstrained configuration. The local deformation is breaking locally the perfect periodicity of the crystalline lattice. In the case of small deformation,$C_j$ can be allowed to vary in space in \cref{eq:crystal_Fourier_series}. Representing $C_j$ with a phase $A_j$ and an amplitude $P_j$, a pure displacement is only contributing in the phase component. The strain information is therefore embedded in $P_{g_{j}}(\vec{r})$ such that $P_{g_{j}}(\vec{r})=2\pi\Delta \vec{g_{j}}(\vec{r})\cdot\vec{r}$ where $\Delta \vec{g_j}$ represent the variation of the crystalline vector compared to its unstrained state (ref hytch 1998).
\begin{equation}
\begin{gathered}
\forall (x,y) \in \mathbb{R}^{2},I_C(\vec{r})=\sum_{j=-\infty}^{j=+\infty}C_j(\vec{r})e^{i(\vec{g_j}\cdot\vec{r})} \\
\forall (x,y) \in \mathbb{R}^{2},I_C(\vec{r})=\sum_{j=-\infty}^{j=+\infty}A_je^{i(\vec{g_j}\cdot\vec{r})+iP_{g_{j}}(\vec{r})}
\end{gathered}
\label{eq:crystal_strain_Fourier_series}
\end{equation}

\item \textbf{STEM Moir{\'e} hologram (SMH)}: EM collected in STEM and resulting from the 
Moir{\'e} interference between the scanning grid and the crystal lattice.

Combining \cref{eq:crystal_strain_Fourier_series} and \cref{eq:sampling}, a STEM Moir{\'e} hologram $I_{SMH}$ can be described as follows
\begin{equation}
I_{SMH}(\vec{r})=\sum_{q\in Q}\delta(\vec{r}-p\vec{q})\times\sum_{j=-\infty}^{j=+\infty}A_je^{i(\vec{g_j}\cdot\vec{r})+iP_{g_{j}}(\vec{r})}
\label{eq:SMH_1}
\end{equation}
Since the Dirac comb function is also periodic, the sampler can also be represented into Fourier series
\begin{equation}
\forall (x,y) \in \mathbb{R}^{2}, S(\vec{r})=\sum_{q\in Q}\delta(\vec{r}-p\vec{q}) = \frac{1}{(2\pi)^2}\sum_{q\in Q}\sum_{l=-\infty}^{l=+\infty}e^{il(\vec{r}-p\vec{q})}
\label{eq:SMH_2}
\end{equation}
Using \cref{eq:SMH_2} in \cref{eq:SMH_1}, it is possible to recognize an interference equation between multiple plane waves (a more complex version of \cref{eq:hologram}.
\begin{equation}
I_{SMH}(\vec{r})=\frac{1}{(2\pi)^2}\sum_{q\in Q}\sum_{l=-\infty}^{l=+\infty}\sum_{j=-\infty}^{j=+\infty}A_je^{i(\vec{g_j}\cdot\vec{r}+l(\vec{r}-p\vec{q}))+iP_{g_{j}}(\vec{r})}
\label{eq:SMH_3}
\end{equation}
By modifying $p$ the scanning periodicity (or the pixel size), it is possible to adjust the spatial frequency of the SMH solving \cref{eq:SMH_3} 
\item \textbf{Strain map}: 2D array mapping the evolution of one element of the 2D strain or rotation 
tensor.\newline
If $\vec{g_j}=g_{j_{x}}\vec{u_{x}}+g_{j_{y}}\vec{u_{y}}$ and $\Delta \vec{g_{j}}=\Delta g_{j_{x}}\vec{u_{x}}+\Delta g_{j_{y}}\vec{u_{y}}$ are known for two non-collinear crystalline wave vectors, then the strain tensor can be deduced. First both the unstrained matrix $G$ and the variation of the crystalline wave vectors matrix $\Delta G$ are generated to calculate the distortion matrix $D$ with $I_{d}$ representing the identity matrix. 
\begin{equation}
\begin{gathered}
	G_{ref} =
	\begin{bmatrix}
	g_{1_{x}} & g_{1_{y}} \\
	g_{2_{x}} & g_{2_{y}} 
	\end{bmatrix} \\
	\Delta G =
	\begin{bmatrix}
	\Delta g_{1_{x}} & \Delta g_{1_{y}} \\
	\Delta g_{2_{x}} & \Delta g_{2_{y}} 
	\end{bmatrix} \\
D = ({\Delta G}^{T})^{-1}{G_{ref}}^{T}-I_{d}
\end{gathered}
\label{eq:strain_1}
\end{equation}
From the distortion matrix, the strain and rotation tensor can be finally evaluated with $\varepsilon$ the strain tensor and $\omega$ the rotation tensor (see annexe D in ref{Hytch1998} and equation (30) in ref{Rouviere2005}). 
\begin{equation}
\begin{gathered}
\varepsilon = \begin{bmatrix}
	\varepsilon_{xx} & \varepsilon_{xy} \\
	\varepsilon_{xy} & \varepsilon_{yy} 
	\end{bmatrix} = \frac{1}{2}(D+D^{T}) \\
\omega = \begin{bmatrix}
	0 & \omega_{xy} \\
	-\omega_{xy} & 0 
	\end{bmatrix} = \frac{1}{2}(D-D^{T})
\end{gathered}
\label{eq:strain_2}
\end{equation}


\end{itemize}


\subsubsection{Physical System Description}

The physical system of \progname{}, as shown in Figure~?,
includes the following elements:


\wss{A figure here may make sense for most SRS documents}

% \begin{figure}[h!]
% \begin{center}
% %\rotatebox{-90}
% {
%  \includegraphics[width=0.5\textwidth]{<FigureName>}
% }
% \caption{\label{<Label>} <Caption>}
% \end{center}
% \end{figure}


\subsubsection{Goal Statements}

\noindent Given the system description, the goal statements are:
\begin{GS}
\normalfont Extract quantitatively the chosen crystalline wave vectors. This corresponds to extract $\vec{g_{j}}$ from $I_{SMH}$.
\label{GS_1}
\end{GS}
\begin{GS}
\normalfont Extract quantitatively the variation of the chosen crystalline wave vectors. This corresponds to extract $P_{g_{j}}$ from $I_{SMH}$.
\label{GS_2}
\end{GS}
\begin{GS}
\normalfont Display, on each pixel, all the elements of the 2D strain and rotation tensor which are the parameters $\varepsilon_{xx}$, $\varepsilon_{xy}$, $\varepsilon_{yy}$ and $\omega_{xy}$ in \cref{eq:strain_2}
\label{GS_3}
\end{GS}

\subsection{Solution Characteristics Specification}


\subsubsection{Assumptions}

\begin{A}
\normalfont The microscope has a limit of resolution corresponding to the probe size and thus cannot resolve any spatial frequency higher than $g_{lim}$. As a consequence, the expression of $I_C$ in \cref{eq:crystal_strain_Fourier_series} is simplified since the series becomes a finite sum considering $F$ a floor function.
\begin{equation}
\forall (x,y) \in \mathbb{R}^{2},I_C(\vec{r})=\sum_{j=-F(g_{lim})}^{j=+F(g_{lim})+1}A_je^{i(\vec{g_j}\cdot\vec{r})+iP_{g_{j}}(\vec{r})}
\end{equation}
\label{A_1}
\end{A}
\begin{A}
\normalfont Since the STEM EM is discretized in pixels, the smallest features possible is composed of two pixels. Therefore, in reciprocal space, the maximum range of spatial frequency detectable is $[-\frac{1}{2p},\frac{1}{2p}]^{2}$.
\label{A_2}
\end{A}
\begin{A}
\normalfont The probe size is smaller than the area covered by one pixel. Therefore, information gathered on one pixel is only provided by the area covered by the pixel (no blurring).
\label{A_3}
\end{A}
\begin{A}
\normalfont The variation of the strain field (or deformation field) is small. As a consequence $\nabla(\Delta \overrightarrow{g(\vec{r})}\cdot\vec{r})\approx\Delta \overrightarrow{g(\vec{r})}$
\label{A_4}
\end{A}
\begin{A}
\normalfont The strain magnitude is small (elastic regime). As a consequence, $\frac{||\vec{\Delta g}||}{||\vec{g}||}<0.1$
\label{A_5}
\end{A}
\subsubsection{Theoretical Models}\label{sec_theoretical}

dwdqwd

\subsubsection{General Definitions}\label{sec_gendef}


\subsubsection*{Detailed derivation of simplified rate of change of temperature}

\wss{This may be necessary when the necessary information does not fit in the
  description field.} 

\subsubsection{Data Definitions}\label{sec_datadef}


\subsubsection{Instance Models} \label{sec_instance}    

\subsubsection*{Derivation of ...}

\wss{May be necessary to include this subsection in some cases.}

\subsubsection{Data Constraints} \label{sec_DataConstraints}    

\subsubsection{Properties of a Correct Solution} \label{sec_CorrectSolution}

\noindent
A correct solution must exhibit \wss{fill in the details}

\section{Requirements}

This section provides the functional requirements, the business tasks that the
software is expected to complete, and the nonfunctional requirements, the
qualities that the software is expected to exhibit.

\subsection{Functional Requirements}


\subsection{Nonfunctional Requirements}

\wss{List your nonfunctional requirements.  You may consider using a fit
  criterion to make them verifiable.}

\section{Likely Changes}    


\section{Traceability Matrices and Graphs}


\wss{You will have to modify these tables for your problem.}

\newpage

\bibliographystyle {ieeetr}
%\bibliography {../../ReferenceMaterial/References}

\newpage

\section{Appendix}

\wss{Your report may require an appendix.  For instance, this is a good point to
show the values of the symbolic parameters introduced in the report.}

\subsection{Symbolic Parameters}


\end{document}
