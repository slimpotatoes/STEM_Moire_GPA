\documentclass[12pt]{article}

% Author's up-front packages
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}

% Packages on template
\usepackage{amsmath, mathtools}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{colortbl}
\usepackage{xr}
\usepackage{hyperref}
\usepackage{longtable}
\usepackage{xfrac}
\usepackage{tabularx}
\usepackage{float}
\usepackage{siunitx}
\usepackage{booktabs}
\usepackage{caption}
\usepackage{pdflscape}
\usepackage{afterpage}

% ---- Author's choice to remove them ----
%\usepackage[round]{natbib}
%\usepackage{refcheck}

% Author's packages
\usepackage{cite}
\usepackage{indentfirst}
\usepackage{cleveref}
\usepackage{float}
%\usepackage{amsthm}
\usepackage{xcolor}
\definecolor{shadecolorIM}{RGB}{0,200,0}
\definecolor{shadecolorT}{RGB}{0,191,255}
\definecolor{shadecolorDD}{RGB}{186,85,211}
\definecolor{shadecolorR}{RGB}{255,0,0}

\hypersetup{
    %bookmarks=true,			% show bookmarks bar?
    colorlinks=true,			% false: boxed links; true: colored links
    linkcolor=red,				% color of internal links (change box color with 
%linkbordercolor)
    citecolor=green,        % color of links to bibliography
    filecolor=magenta,      % color of file links
    urlcolor=blue           % color of external links
}

\input{../Comments}

% For easy change of table widths
\newcommand{\colZwidth}{1.0\textwidth}
\newcommand{\colAwidth}{0.13\textwidth}
\newcommand{\colBwidth}{0.82\textwidth}
\newcommand{\colCwidth}{0.1\textwidth}
\newcommand{\colDwidth}{0.05\textwidth}
\newcommand{\colEwidth}{0.8\textwidth}
\newcommand{\colFwidth}{0.17\textwidth}
\newcommand{\colGwidth}{0.5\textwidth}
\newcommand{\colHwidth}{0.28\textwidth}


% Used so that cross-references have a meaningful prefix
\newcommand{\progname}{STEM Moir{\'e} GPA}

\usepackage{fullpage}

%Set the custom referencing system
	% Goal Statement
\newtheorem{GS}{GS}
\crefname{GS}{GS}{GSs}
	% Assumption
\newtheorem{A}{A}
\crefname{A}{A}{As}
	% Theoretical Model
\newtheorem{T}{T}
\crefname{T}{T}{Ts}
	% Data Definition
\newtheorem{DD}{DD}
\crefname{DD}{DD}{DDs}
	% Data Constraints
\newtheorem{DC}{DC}
\crefname{DC}{DC}{DCs}
	% Instance Model
\newtheorem{IM}{IM}
\crefname{IM}{IM}{IMs}
	% General Definition
\newtheorem{GD}{GD}
\crefname{GD}{GD}{GDs}
	% Requirement
\newtheorem{R}{R}
\crefname{R}{R}{Rs}
	% Non Functional Requirement
\newtheorem{NR}{NR}
\crefname{NR}{NR}{NRs}

\begin{document}


\title{Software Requirements Specifications (SRS) \\
STEM Moir{\'e} GPA} 
\author{Alexandre Pofelski \\
		macid: pofelska \\
		github: slimpotatoes}
\date{\today}

\maketitle

\clearpage

\pagenumbering{roman}
\tableofcontents

\clearpage

\section{Revision History}

\begin{table}[h]
\caption{\bf Revision History}
\begin{tabularx}{\textwidth}{p{3cm}p{2cm}X}
\toprule {\bf Date} & {\bf Version} & {\bf Notes}\\
\midrule
19/09/2017 & 1.0 & First Draft\\
\bottomrule
\end{tabularx}
\end{table}

\clearpage

\section{Reference Material}

\subsection{Table of Units}

Throughout this document SI 
(\href{<https://physics.nist.gov/cuu/Units/index.html>}{Syst\`{e}me 
Internationale d'Unit\'{e}s}) is employed as the unit system. In addition to the 
basic units, several derived units are used as described below.  For each unit, 
the symbol is given followed by a description of the unit and the SI name.\par 
\bigskip

\renewcommand{\arraystretch}{1.2}
%\begin{table}[ht]
  \noindent \begin{tabular}{l l l} 
    \toprule		
    \textbf{Symbol} & \textbf{Base quantity} & \textbf{Name SI}\\
    \midrule 
    \si{\metre} & length & metre\\
    \si{\per\metre} & reciprocal meter & wave number\\
    \bottomrule
  \end{tabular}
  %	\caption{Provide a caption}
%\end{table}

\wss{Only include the units that your SRS actually uses}

\subsection{Table of Symbols}

The table that follows summarizes the symbols used in this document along with
their units if applicable.

\renewcommand{\arraystretch}{1.2}
%\noindent \begin{tabularx}{1.0\textwidth}{l l X}
\noindent \begin{longtable*}{l l p{12cm}} \toprule
\textbf{Symbol} & \textbf{Unit} & \textbf{Description}\\
\midrule 
$\mathcal{B}$ & & 2D orthonormal base \\
$\mathcal{C}$ & & Ceiling function \\
$\delta$ & & Dirac delta function \\
$\Delta \overrightarrow{g_{j}}^{M_{exp}}$ & \si{\per\nano\meter} & Variation of the $j^{th}$ Moir{\'e} wave vector of $SMH_{exp}$\\
$\Delta \overrightarrow{g_{j}}^{C_{exp}}$ & \si{\per\nano\meter} & Variation of the $j^{th}$ crystalline wave vector of $SMH_{exp}$\\
$\varepsilon$ & & Strain tensor \\
$\varepsilon_{xx}$ & & Uniaxial strain component along $\vec{u_x}$ \\
$\varepsilon_{yy}$ & & Uniaxial strain component along $\vec{u_y}$ \\
$\varepsilon_{xy}$ & & Shear strain component in base $\mathcal{B}$ \\
$\mathcal{FT}$ & & Fourier transform \\
$\Gamma$ & & Spatial frequency range \\
$\overrightarrow{g_{j}}$ & \si{\per\nano\meter} & $j^{th}$ wave vector \\
$g_{j_x}$ & \si{\per\nano\meter} & Component of the $j^{th}$ wave vector along $\vec{u_x}$ \\
$g_{j_y}$ & \si{\per\nano\meter} & Component of the $j^{th}$ wave vector along $\vec{u_y}$ \\
$\overrightarrow{g_{j}}^{C}$ & \si{\per\nano\meter} & $j^{th}$ crystalline wave vector \\
$\overrightarrow{g_{j}}^{C_{ref}}$ & \si{\per\nano\meter} & $j^{th}$ crystalline wave vector of $I_{C_{ref}}$ \\
$\overrightarrow{g_{j}}^{C_{exp}}$ & \si{\per\nano\meter} & $j^{th}$ crystalline wave vector of $SMH_{exp}$\\
$\overrightarrow{g_{j}}^{C_{exp}}_{uns}$ & \si{\per\nano\meter} & $j^{th}$ crystalline wave vector of $SMH_{exp}$ at its unstrained state\\
$\overrightarrow{g_{j}}^{M_{exp}}$ & \si{\per\nano\meter} & $j^{th}$ Moir{\'e} wave vector of $SMH_{exp}$\\
$\overrightarrow{g_{j}}^{M_{exp}}_{uns}$ & \si{\per\nano\meter} & $j^{th}$ Moir{\'e} wave vector of $SMH_{exp}$ at its unstrained state\\
$i$ & & Imaginary unit \\
$I$ & & Intensity (or number of counts) \\
$\mathbb{I}$ & & Sub-set of $\mathbb{R}$ representing the position of the pixels in an image\\
$I_{C_{ref}}$ & & 2D array representing the reference crystal structure \\
$I_{SMF_{exp}}$ & & 2D array representing the experimental SMH\\
$I_{SMF_{sim}}$ & & 2D array representing the simulated SMH\\
$I_{\varepsilon_{xx}}$ & & 2D array representing the uniaxial strain component along $\vec{u_x}$ \\
$I_{\varepsilon_{yy}}$ & & 2D array representing the uniaxial strain component along $\vec{u_y}$ \\
$I_{\varepsilon_{xy}}$ & & 2D array representing the shear strain component in base $\mathcal{B}$ \\
$M_j$ & & Mask function in Fourier space including the $j^{th}$ wave vector\\
$\mathbb{N}$ & & Set of natural numbers\\
$\nabla$ & & Gradient operator\\
$\nabla u$ & & Displacement gradient tensor\\
$\vec{\nu}$ & \si{\per\nano\meter} & Vector position in Fourier space\\
$\omega$ & & Rotation tensor\\
$\omega_{xy}$ & rad & Rotation element of the rotation tensor\\
$p$ & \si{\nano\meter} & Pixel size\\
$P_{\overrightarrow{X}}$ & rad & 2D array representing $2\pi\overrightarrow{X}\cdot\vec{r}$\\
$\overrightarrow{q_{n_j,m_j}}$ & & Sampling vector $\vec{q} \in Q$ of couple $(n_j,m_j)$\\
$Q$ & & Set such that $Q=\{\forall (n,m) \in \mathbb{Z}^{2}, \vec{q}=n\vec{u_x}+m\vec{u_y}\}$ \\
$\vec{r}$ & \si{\nano\meter} & Vector position \\
$\mathbb{R}$ & & Set of real numbers \\
$rot$ & & Curl operator\\
$SMH_{exp}$ & & 2D array representing the experimental STEM Moir{\'e} Hologram \\
$SMH_{sim}$ & & 2D array representing the simulated STEM Moir{\'e} Hologram \\
$\vec{u_x}$ & & Unitary vector from base $\mathcal{B}$ \\
$\vec{u_y}$ & & Unitary vector from base $\mathcal{B}$ \\
$\wedge$ & & Cross product operator\\
$\mathbb{Z}$ & & Set of integer numbers\\
\bottomrule
\end{longtable*}

\subsection{Abbreviations and Acronyms}

\renewcommand{\arraystretch}{1.2}
\begin{tabular}{l l} 
  \toprule		
  \textbf{symbol} & \textbf{description}\\
  \midrule 
  A & Assumption\\
  AU & Arbitrary Unit\\
  DC & Data Constraint \\
  DD & Data Definition\\
  EM & Electron Micrograph \\
  GD & General Definition\\
  GPA & Geometrical Phase Analysis \\
  GS & Goal Statement\\
  IM & Instance Model\\
  LC & Likely Change\\
  PS & Physical System Description\\
  NR & Non functional Requirement\\
  R & Requirement\\
  SMH & STEM Moir{\'e} Hologram \\
  SRS & Software Requirements Specification\\
  STEM & Scanning Transmission Electron Microscopy \\
  T & Theoretical Model\\
  \bottomrule
\end{tabular}\\

\wss{Add any other abbreviations or acronyms that you add}

\newpage
\pagenumbering{arabic}

\section{Introduction}

\wss{This SRS template is based on \citet{SmithAndLai2005, SmithEtAl2007}.  It
  will get you started, but you will have to make changes.  Any changes to
  section headings should be approved by the instructor, since that implies a
  deviation from the template.  Although the bits shown below do not include
  type information, you may need to add this information for your problem.}


\wss{If you are documenting a family of models, you can start from this same
  template, but you will have to add a section for variabilities.  For program
  families you should look at \cite{Smith2006, SmithMcCutchanAndCarette2017}.
  You should be able to do one document that captures the commonality analysis
  and the requirements.}

\subsection{Purpose of Document}

The purpose of the document is to provide a detailed description of the functional and the non-functional requirements of the \progname{} software.  The theoretical models on which the requirements are based on are also described to provide the context of each instance model.

\subsection{Scope of Requirements} 

The scope of requirements are limited to the realization of \cref{GS_1} which corresponds to transform a certain type of data to another one based on multiple user inputs.

\subsection{Characteristics of Intended Reader} 

The intended reader is expected to have a minimum knowledge in mathematics at undergraduate level. Simplification of some physical concepts are proposed to make the document technically accessible. Nevertheless, a basic knowledge in Transmission Electron Microscopy, electron/matter interaction and elastic strain theory is recommended to get a deeper understanding of the document. 

\subsection{Organization of Document}

The document follows the template of the SRS document proposed by \cite{SmithAndLai2005, SmithEtAl2007}. 

\section{General System Description}

This section identifies the interfaces between the system and its environment,
describes the user characteristics and lists the system constraints.

\subsection{System Context}

\progname{} is intended to transform specific data acquired microscope into physical information related to the sample analysed. The variety of samples is potentially huge therefore to cover the maximum of cases, multiple interactions with the user are required to process the data correctly. Responsibilities between the user and the \progname{} are described as follows:

\begin{itemize}
\item User Responsibilities:
\begin{itemize}
\item Provide the minimum information required by the \progname{} software.
\item Use the software in the limits it is intended to.
\item Be aware of the potential effects of user inputs on the quality of the final data.
\item Judge the correctness of the data.
\item Be particularly cautious on the use of the final data quantitatively. The quantitative aspect cannot be fully uncorrelated from the user inputs. 
\item Use a pointing device, a keyboard and a display to interface with \progname{}.
\end{itemize}
\item \progname{} Responsibilities:
\begin{itemize}
\item Preserve the integrity of original data and not add any hidden processing steps on the final data such as, but not limited to, smoothing, blurring, averaging, de-noising and binning.
\item Inform user of wrong format or missing information regarding the inputs.
\item Inform the user of a potential insufficient quality of the final results which could lead to non reliable physical interpretations.
\end{itemize}
\end{itemize}

\subsection{User Characteristics} \label{SecUserCharacteristics}

The end user of \progname{} should have a relative strong background in Physics, Mathematics and Electron Microscopy to get a reliable sense of the data processed. The multiple interactions between the user and \progname{} have a significant impact on the final results which can lead to some physical misinterpretations. 

\subsection{System Constraints}

\progname{} is for the moment limited to the study of mono-crystalline material undergoing a relative small deformation with respect to its unstrained state. Another constraint is to be considered because of the electron microscopy community. Most of the files acquired on the microscope are in dm3 format, an non-standard format used by the detector manufacturer. Therefore, \progname{} software needs to be able to read any dm3 files to be considered by the research community.

\section{Specific System Description}
\subsection{Problem Description} \label{Sec_pd}

STEM Moir{\'e} GPA project is a software capable of converting a STEM Moir{\'e} 
hologram into 2D relative strain maps. Terminologies, the context and a detailed description of the physical system is proposed below.

\subsubsection{Terminology and Definitions}

Regarding the complexity of the electron/matter interaction, some crude 
simplifications are proposed to describe the terminologies below. While 
sometimes not realistic, the simplifications should help in visualizing the 
context and the type of data the STEM Moir{\'e} GPA software is subjected to. Nevertheless, all the simplifications proposed are not affecting the definition of the concept used at the software level.

\begin{itemize}

\item \textbf{2D Cartesian coordinate system}: orthonormal coordinate system model by the orthonormal base $\mathcal{B}=(O,\vec{u_x},\vec{u_y})$ such that any vector $\vec{r}$ can be expressed as the following:
\begin{equation}
\forall (x,y) \in \mathbb{R}^{2}, \vec{r}=x\vec{u_x}+y\vec{u_y}
\end{equation}
\item \textbf{Pixel}: smallest addressable element sampling a 2D continuum.
\item \textbf{Electron Micrograph (EM)}: 2D array collected in an electron microscope representing the number of electron crossing the sample (intensity) at each pixel location.
\item \textbf{Scanning grid}: set representing the succession of the STEM probe positions when collecting the STEM EM. Equivalently the scanning grid represents the relative position of the pixel with respect to the sample when acquiring the EM. A simplified version of the 
STEM EM formation can be visualized in \cref{fig:STEM_imaging_Fig}. The positions of the STEM probe are located at the intersection of the black grid lines.
\begin{figure}[H]
\includegraphics[width=\linewidth]{Figures/STEM_imaging_Fig.png}
\caption{On the left hand side, a schematic of the STEM EM formation with the STEM probe scanning the sample at each intersection of the grid lines. The electrons crossing the sample are collected on the detector and counted during the acquisition time. On the right hand side is presented a STEM EM on a pure silicon sample revealing its atomic structure. In the inset is highlighted the type of data the STEM EM corresponds to which is a 2D array with the intensity collected on each element of the array.}
\label{fig:STEM_imaging_Fig}
\end{figure}
\item \textbf{Hologram}: Result from an interference between two or multiples waves. \newline
Let consider two monochromatic plane waves $\psi_1$ and $\psi_2$ with their respective amplitude $A_j$, phase $\phi_j$ and wave vector $\vec{k_j}$ in the 2D Cartesian system interfering with each other. The resulting hologram $\psi_H$ represented by the intensity $I_H$ can be modelled as follows with :
\begin{equation}
\forall (x,y) \in \mathbb{R}^{2}, \psi_H(\vec{r})=\psi_1+\psi_2= A_1e^{i(\vec{k_1}\cdot\vec{r})+i\phi_1}+A_2e^{i(\vec{k_2}\cdot\vec{r})+i\phi_2}
\end{equation}
\begin{equation}
\begin{split}
\forall (x,y) \in \mathbb{R}^{2}, I_H(\vec{r})=\psi_H\psi_H^{*}= & A_{1}^{2}+A_{2}^{2}+ \\ & A_{1}A_{2}(e^{i(\vec{k_1}-\vec{k_2})\cdot\vec{r}+i(\phi_1-\phi_2)}+e^{i(\vec{k_2}-\vec{k_1})\cdot\vec{r}+i(\phi_2-\phi_1)})
\end{split}
\label{eq:hologram}
\end{equation}
The more waves are contributing to the hologram, the more complex \cref{eq:hologram} will be. However, similar factors will appear with constants and cross product terms.
\item \textbf{Moir{\'e} hologram}: Result from interference between two or multiple waves with similar but not equal wave numbers (or wave vectors in 2D).
\item \textbf{Crystal lattice}: Periodic arrangement of atoms forming matter.
\item \textbf{STEM Moir{\'e} hologram (SMH)}: EM collected in STEM and resulting from the 
Moir{\'e} interference between the scanning grid and the crystal lattice. 
\item \textbf{Strain map}: 2D array mapping the evolution of one element of the 2D strain or rotation 
tensor. 
\end{itemize}

\subsubsection{Physical System Description}

The physical system of \progname{}, as shown in Figure~?,
includes the following elements:


\wss{A figure here may make sense for most SRS documents}

% \begin{figure}[h!]
% \begin{center}
% %\rotatebox{-90}
% {
%  \includegraphics[width=0.5\textwidth]{<FigureName>}
% }
% \caption{\label{<Label>} <Caption>}
% \end{center}
% \end{figure}


\subsubsection{Goal Statements}
\noindent Given the system description, the goal statement is:
\begin{GS}
\normalfont Extract and display the relative 2D strain field from a STEM Moir{\'e} hologram.
\label{GS_1}
\end{GS}

\subsection{Solution Characteristics Specification}

\subsubsection{Assumptions}

\begin{A}
\normalfont The microscope has a limit in resolution corresponding to the probe size and thus cannot resolve any spatial frequency higher than $g_{j_{lim}}$. 
\label{A_1}
\end{A}
\begin{A}
\normalfont Since the STEM EM is discretized in pixels, the smallest feature detectable is composed of two pixels. Therefore, in reciprocal space, the maximum range of spatial frequency detectable is $\Gamma=[-\frac{1}{2p},\frac{1}{2p}]^{2}$.
\label{A_2}
\end{A}
\begin{A}
\normalfont The probe size is smaller than the area covered by one pixel. Therefore, information gathered on one pixel is only provided by the area covered by the pixel (no blurring) and \cref{A_1} is the only limiting factor regarding resolution.
\label{A_3}
\end{A}
\begin{A}
\label{A_4}
\normalfont The variation of the deformation field is small. Therefore,
\begin{equation*}
\begin{gathered}
\forall \vec{r} \in \mathbb{R}^2, \ \nabla (\Delta\overrightarrow{g_j}\cdot\vec{r})= (\Delta\overrightarrow{g_j}\cdot\nabla)\vec{r}+(\vec{r}\cdot\nabla)\Delta\overrightarrow{g_j}+\Delta\overrightarrow{g_j}\wedge rot(\vec{r})+\vec{r}\wedge rot(\Delta\overrightarrow{g_j}))\\
\forall \vec{r} \in \mathbb{R}^2, \ \nabla (\Delta\overrightarrow{g_j}\cdot\vec{r})\approx \Delta\overrightarrow{g_j}
\end{gathered}
\end{equation*}
\end{A}
\begin{A}
\label{A_5}
\normalfont The deformation magnitude is small. Therefore, $\frac{||\Delta\overrightarrow{g_j} ||}{||\overrightarrow{g_j} ||}\leq 0.1$
\end{A}
\begin{A}
\label{A_6}
\normalfont The user knows the crystal structure of the sample analysed at its unstrained state or can provide a reference in which is embedded the crystal structure information at its unstrained state.
\end{A}
\begin{A}
\label{A_7}
\normalfont The sample, from which the SMH is acquired, is mono-crystalline.
\end{A}

\subsubsection{Theoretical Models}\label{sec_theoretical}

\begin{T}
\label{T_1}
\noindent\colorbox{shadecolorT}{\normalfont \textbf{2D periodic sampling}}
\normalfont
\begin{itemize}
\item \underline{Equation}: \Cref{eq:sampling_simplified}
\item \underline{Description}: In the 2D Cartesian coordinate system $\mathcal{B}$, the scanning grid can be seen as sampler $S$ of a continuous function $f$. In the context of the \progname{} project, the sampler is set to be periodic with the same periodicity $p$ (called pixel size) in both $x$ and $y$ directions (2D Dirac comb). The resulting sampled version $f_S$ of $f$ can be represented as the following with $\delta$ representing the Dirac function:
\begin{equation}
\begin{gathered}
\forall (x,y) \in \mathbb{R}^{2}, f_S(x,y)=S(x,y)\times f(x,y) \\
\forall (x,y) \in \mathbb{R}^{2}, f_S(x,y)=\sum_{n=-\infty}^{n=+\infty}\sum_{m=-\infty}^{m=+\infty}\delta(x-np,y-mp)\times f(x,y)
\end{gathered}
\label{eq:sampling}
\end{equation}
For shorter notations, it is possible to define a set Q as follows $Q=\{\forall (n,m) \in \mathbb{Z}^{2}, \vec{q}=n\vec{u_x}+m\vec{u_y}\}$ and thus simplify \cref{eq:sampling}
\begin{equation}
\forall (x,y) \in \mathbb{R}^{2}, f_S(\vec{r})=\sum_{q\in Q}\delta(\vec{r}-p\vec{q}) f(\vec{r})
\label{eq:sampling_simplified}
\end{equation}
\item \underline{Source}: Trouver un truc pr sampling (bouquin sur la table d'isobel
\item \underline{Ref by}: \cref{DD_2}, \cref{IM_1}, \cref{IM_4}
\end{itemize}
\end{T}

\begin{T}
\label{T_2}
\noindent\colorbox{shadecolorT}{\normalfont \textbf{Geometrical Phase Analysis}}
\normalfont
\begin{itemize}
\item \underline{Equation}: \Cref{eq:GPA_method}
\item \underline{Description}: Let consider a function $f$ decomposed in Fourier series as the following with 
\begin{equation}
\begin{gathered}
\forall \vec{r}=(x_1,...,x_n) \in \mathbb{R}^n, f(\vec{r})=\sum_{j=-\infty}^{j=+\infty}C_je^{i(\vec{k_j}\cdot\vec{r})} \\
\forall \vec{r}=(x_1,...,x_n) \in \mathbb{R}^n, f(\vec{r})=\sum_{j=-\infty}^{j=+\infty}A_je^{i((\vec{k_j}\cdot\vec{r})+B_j)}
\end{gathered}
\end{equation}
If there is a small perturbation locally of the n-dimensions wave vector $\vec{k_j}$, it is possible to model it allowing $B_j$ to be a function of $\vec{r}.$ 
\begin{equation}
\forall \vec{r}=(x_1,...,x_n) \in \mathbb{R}^n, f(\vec{r})=\sum_{j=-\infty}^{j=+\infty}A_je^{i((\vec{k_j}\cdot\vec{r})+B_j(\vec{r}))}
\end{equation}
The objective of GPA is to extract the perturbation, one chosen $B_j(\vec{r})$, from $f$ in Fourier space. Let's consider the Fourier transform of $f$ such that
\begin{equation*}
\begin{gathered}
\forall \vec{\nu}=(\nu_1,...,\nu_n) \in \mathbb{R}^n, \forall \vec{r}=(x_1,...,x_n) \in \mathbb{R}^n, \widetilde{f}(\vec{\nu})=\mathcal{FT}(f(\vec{r})) \\
\forall \vec{\nu}=(\nu_1,...,\nu_n) \in \mathbb{R}^n, \forall \vec{r}=(x_1,...,x_n) \in \mathbb{R}^n, \widetilde{f}(\vec{\nu})=\sum_{j=-\infty}^{j=+\infty}\mathcal{FT}(C_j(\vec{r})\times e^{i(\vec{k_j}\cdot\vec{r})})
\end{gathered}
\end{equation*}
\begin{equation}
\begin{gathered}
\forall \vec{\nu}\in \mathbb{R}^n, \widetilde{f}(\vec{\nu})=\sum_{j=-\infty}^{j=+\infty}\widetilde{C_j}(\vec{\nu})\ast\delta(\vec{\nu}-\vec{k_j})\\
\forall \vec{\nu}\in \mathbb{R}^n, \widetilde{f}(\vec{\nu})=\sum_{j=-\infty}^{j=+\infty}\widetilde{C_j}(\vec{\nu}-\vec{k_j})
\end{gathered}
\end{equation}
If all the $\vec{k_j}$ are separated enough to be isolated with a mask, then $B_j(\vec{r})$ can be extracted by considering the inverse Fourier transform of the masked area and expressing the result in term of amplitude and phase. In mathematical formalism, $B_j(\vec{r})$ is extracted as follows with $\mathcal{G}=([\nu_1^D,\nu_1^U],...,[\nu_n^D,\nu_n^U])$.
\begin{equation*}
\begin{gathered}
\text{if} \ \exists \ M :
\begin{array}{|ccl}
\mathbb{R}^{n} & \longrightarrow & \mathbb{C} \\
\vec{\nu} & \longmapsto & M(\vec{\nu}) 
    \end{array} / \begin{cases}
    					M(\vec{\nu}-\vec{k_j})\widetilde{f}(\vec{\nu})=\widetilde{C_j}(\vec{\nu}-\vec{k_j}) & \text{for} \ \vec{\nu} \in \mathcal{G} \\
    					M(\vec{\nu}-\vec{k_j})\widetilde{f}(\vec{\nu})=0 & 
    				 \end{cases} \\
\end{gathered}
\end{equation*}
\begin{equation}
\Rightarrow \begin{array}{l}
|\mathcal{FT}^{-1}[M(\vec{\nu})\widetilde{f}(\vec{\nu}+\vec{k_j})]|=|\mathcal{FT}^{-1}[\widetilde{C}(\vec{\nu})]|=A_j \\
arg(\mathcal{FT}^{-1}[M(\vec{\nu})\widetilde{f}(\vec{\nu}+\vec{k_j})])=arg(\mathcal{FT}^{-1}[\widetilde{C}(\vec{\nu})])=B_j(\vec{r})
\end{array}
\label{eq:GPA_method}
\end{equation}

\item \underline{Source}: \cite{Hytch1998,Rouviere2005}
\item \underline{Ref by}: \cref{DD_1}, \cref{IM_2}
\end{itemize}
\end{T}

\subsubsection*{Description of the GPA method in a 1D coordinate system}
\noindent Let's consider a function $f$ such that 
\begin{equation*}
\begin{gathered}
\forall x \in \mathbb{R}, f(x)=C_0e^{i(k_0x)}+C_1e^{i(k_1x)} \\
\end{gathered}
\end{equation*}
Let's consider a small perturbation of $k_1$ modelled as the following
\begin{equation*}
\begin{gathered}
\forall x \in \mathbb{R}, f(x)=C_0e^{i(k_0x)}+A_1e^{i(k_1x)+iB_1(x)} \\
\end{gathered}
\end{equation*}
Applying the GPA method on $f$,
\begin{equation*}
\begin{gathered}
\forall \nu \in \mathbb{R}, \widetilde{f}(\nu)=C_0\delta(\nu-k_0)+\widetilde{C_1}(\nu)\ast\delta(\nu-k_1) \\
\forall \nu \in \mathbb{R}, \widetilde{f}(\nu)=C_0\delta(\nu-k_0)+\widetilde{C_1}(\nu-k_1)
\end{gathered}
\end{equation*}
Considering the perturbation around $k_1$ to be small and that $k_0$ and $k_1$ are enough separated such that the perturbation is located around $k_1$ in frequency space, it is possible to define a mask $M$ such that:
\begin{equation*}
\begin{gathered}
\forall \nu \in \mathbb{R}, M(\nu) = 
\begin{cases}
1 & \text{for} \ \nu-k_1 \in  [-\epsilon,+\epsilon] \ / \ k_0 \notin [k_1-\epsilon,k_1+\epsilon] \\
0
\end{cases}
\end{gathered}
\end{equation*}
In such case, multiply the mask $M$ with the Fourier transform of $f$ isolates $\widetilde{C_1}$ from the sum and can be independently transformed as follows:
\begin{equation*}
\begin{gathered}
\forall \nu \in \mathbb{R}, M(\nu-k_1)\widetilde{f}(\nu)=\widetilde{C_1}(\nu-k_1)
\end{gathered}
\end{equation*}
Setting, $\lambda=\nu-k_1$ and performing the inverse Fourier transform of the masked Fourier transform of $f$, the perturbation can be extracted.
\begin{equation*}
\begin{gathered}
\forall \nu \in \mathbb{R}, M(\lambda)\widetilde{f}(\lambda+k_1)=\widetilde{C_1}(\lambda) \\
\forall x \in \mathbb{R}, \mathcal{FT}^{-1}[M(\lambda)\widetilde{f}(\lambda+k_1)]=C_1(x) \\
\Rightarrow \begin{cases}
|C_1(x)|=A_1 \\
arg(C_1(x))=B_1(x)
\end{cases}
\end{gathered}
\end{equation*}
\begin{T}
\label{T_3}
\noindent\colorbox{shadecolorT}{\normalfont \textbf{Strain decomposition model}}
\normalfont
\begin{itemize}
\item \underline{Equation}: \Cref{eq:strain_2}
\item \underline{Description}: In infinitesimal strain theory with small displacement and small gradient of displacement (\cref{A_4}, \cref{A_5}), the displacement gradient tensor $\nabla u$ can be decomposed in two independent tensors: the symmetric strain tensor $\varepsilon$ and the anti-symmetric rotation tensor $\omega$. Their relationship can be described as follows:
\begin{equation}
\begin{gathered}
\nabla u = \varepsilon + \omega = \begin{bmatrix}
	\varepsilon_{xx} & \varepsilon_{xy} \\
	\varepsilon_{xy} & \varepsilon_{yy} 
	\end{bmatrix} + \begin{bmatrix}
	0 & \omega_{xy} \\
	-\omega_{xy} & 0 
	\end{bmatrix} \\ 
\varepsilon = \frac{1}{2}(\nabla u+(\nabla u)^{T}) \\
\omega = \frac{1}{2}(\nabla u-(\nabla u)^{T})
\end{gathered}
\label{eq:strain_2}
\end{equation}
\item \underline{Source}: \cite{Hytch1998,Rouviere2005}
\item \underline{Ref by}: \cref{DD_3}, \cref{IM_3}, \cref{IM_5}
\end{itemize}
\end{T}

\subsubsection{General Definitions}\label{sec_gendef}

Non applicable for \progname{} software.
\an{Don't know what to put here. Don't see a clear difference between T and GD}

\subsubsection{Data Definitions}\label{sec_datadef}

\renewcommand{\labelitemi}{$\star$}

\begin{DD}
\label{DD_1}
\noindent\colorbox{shadecolorDD}{\normalfont \textbf{Strain in crystal lattice}}
\normalfont
\begin{itemize}
\item \underline{Equation}: \Cref{eq:Strain_GPA}
\item \underline{Description}: For the purpose of the STEM Moir{\'e} GPA, only mono-crystalline samples are analysed (\cref{A_7}). In the case of a perfect periodic atomic arrangement, the crystalline lattice $I_c$ can be described in Fourier series with $C_j$ the complex Fourier coefficient related to the crystalline wave vector $\vec{g_j}$ in the 2D Cartesian system.
\begin{equation}
\forall (x,y) \in \mathbb{R}^{2},I_C(\vec{r})=\sum_{j=-\infty}^{j=+\infty}C_je^{i(\vec{g_j}\cdot\vec{r})}
\label{eq:crystal_Fourier_series}
\end{equation}
If the crystal is elastically deformed, the relative position of the atoms will be slightly modified from their original unstrained configuration. The local deformation is breaking locally the perfect periodicity of the crystalline lattice. In the case of small deformation (\cref{A_5}), $C_j$ can be allowed to vary in space in \cref{eq:crystal_Fourier_series}. Representing $C_j$ with a phase $A_j$ and an amplitude $P_j$, a pure displacement is only contributing in the phase component. The strain information is therefore embedded in $P_{g_{j}}(\vec{r})$ such that $P_{g_{j}}(\vec{r})=2\pi\Delta \overrightarrow{g_{j}}(\vec{r})\cdot\vec{r}$ where $\Delta \overrightarrow{g_j}$ represent the variation of the crystalline vector compared to its unstrained state.
\begin{equation}
\begin{gathered}
\forall (x,y) \in \mathbb{R}^{2},I_C(\vec{r})=\sum_{j=-\infty}^{j=+\infty}C_j(\vec{r})e^{i(\vec{g_j}\cdot\vec{r})} \\
\forall (x,y) \in \mathbb{R}^{2},I_C(\vec{r})=\sum_{j=-\infty}^{j=+\infty}A_je^{i(\vec{g_j}\cdot\vec{r})+iP_{g_{j}}(\vec{r})}
\end{gathered}
\label{eq:crystal_strain_Fourier_series}
\end{equation}
By applying GPA (\cref{T_2}) on \cref{eq:crystal_strain_Fourier_series}, $P_{g_{j}}(\vec{r})$ can be extracted. Then by applying \cref{A_4}, the gradient $\nabla$ of $P_{g_{j}}(\vec{r})$ can be approximate as follows
\begin{equation}
\nabla P_{g_{j}}(\vec{r}) = 2\pi [\nabla( \Delta \overrightarrow{g_j}\cdot\vec{r}  )] \approx 2\pi\Delta \overrightarrow{g_j(\vec{r})}
\label{eq:Strain_GPA}
\end{equation}
\item \underline{Source}: \cite{Hytch1998}
\item \underline{Ref by}: \cref{T_2}, \cref{IM_3}, \cref{IM_5}
\end{itemize}
\end{DD}

\begin{DD}
\label{DD_2}
\noindent\colorbox{shadecolorDD}{\normalfont \textbf{STEM Moir{\'e} hologram}}
\normalfont
\begin{itemize}
\item \underline{Equation}: \Cref{eq:SMH_FT_complete}
\item \underline{Description}: Combining \cref{eq:crystal_strain_Fourier_series} and \cref{eq:sampling}, a STEM Moir{\'e} hologram $I_{SMH}$ can be described as follows
\begin{equation}
\forall (x,y) \in \mathbb{R}^{2}, I_{SMH}(\vec{r})=\sum_{q\in Q}\delta(\vec{r}-p\vec{q})\times\sum_{j=-\infty}^{j=+\infty}A_je^{i(\vec{g_j}\cdot\vec{r})+iP_{g_{j}}(\vec{r})}
\label{eq:SMH_1}
\end{equation}
By modifying $p$ the scanning periodicity (or the pixel size), it is possible to adjust the spatial frequency of the SMH solving \cref{eq:SMH_1}.Applying \cref{A_1} and \cref{A_3}, the expression of $I_C$ in \cref{eq:crystal_strain_Fourier_series} is simplified since the series becomes a finite sum.
\begin{equation}
\forall (x,y) \in \mathbb{R}^{2},I_C(\vec{r})=\sum_{j=-j_{lim}}^{j=+j_{lim}}A_je^{i(\vec{g_j}\cdot\vec{r})+iP_{g_{j}}(\vec{r})}
\label{eq:crystal_lattice_simplified}
\end{equation}
Therefore, the STEM Moir{\'e} hologram $I_{SMH}$ is also simplified as follows:
\begin{equation}
\forall (x,y) \in \mathbb{R}^{2}, I_{SMH}(\vec{r})=\sum_{q\in Q}\delta(\vec{r}-p\vec{q})\times\sum_{j=-j_{lim}}^{j=+j_{lim}}A_je^{i(\vec{g_j}\cdot\vec{r})+iP_{g_{j}}(\vec{r})}
\label{eq:SMH_simplified_1}
\end{equation}
Taking the Fourier transform of $I_{SMH}$, it is possible to notice that $\widetilde{I}_{SMH}$ is $(1/p,1/p)$ periodic.  
\begin{equation}
\begin{gathered}
\forall (\nu_x,\nu_y) \in \mathbb{R}^{2}, \widetilde{I}_{SMH}(\nu_x,\nu_y)=\frac{1}{p^2}\sum_{n=-\infty}^{n=+\infty}\sum_{m=-\infty}^{m=+\infty}\delta(\nu_x-\frac{n}{p},\nu_y-\frac{m}{p})\ast\widetilde{I}_{C}(\nu_x,\nu_y) \\
\forall (\nu_x,\nu_y) \in \mathbb{R}^{2}, \widetilde{I}_{SMH}(\nu_x,\nu_y)=\frac{1}{p^2}\sum_{n=-\infty}^{n=+\infty}\sum_{m=-\infty}^{m=+\infty}\widetilde{I}_{C}(\nu_x-\frac{n}{p},\nu_y-\frac{m}{p}) \\
\forall (\nu_x,\nu_y) \in \mathbb{R}^{2}, \widetilde{I}_{SMH}(\nu_x+\frac{1}{p},\nu_y+\frac{1}{p})=\widetilde{I}_{SMH}(\nu_x,\nu_y)
\end{gathered}
\label{eq:SMH_FT}
\end{equation}
Therefore it is possible to restrain the calculation of $\widetilde{I}_{SMH}$ for $\vec{\nu} \in [-\frac{1}{2p},\frac{1}{2p}]^{2}=\Gamma$ and respect assumption \cref{A_2}. Nevertheless, \cref{eq:SMH_simplified_1} has still an infinite set of terms in the sum since the set Q is not finite. Therefore, \cref{eq:SMH_simplified_1}, at this stage, is not unusable. Applying \cref{A_1}, $\forall (\nu_x,\nu_y) \notin [-g_{lim},g_{lim}]^2, \widetilde{I}_{C}(\nu_x,\nu_y)=0$. As a consequence, $\exists (N_{lim},N_{lim})\in \mathbb{N}^2 / \ \forall (\nu_x,\nu_y) \in \Gamma, \ \widetilde{I}_{C}(\nu_x-\frac{_{lim}}{p},\nu_y-\frac{_{lim}}{p})=0$. It is possible thus to define $Q_{lim}=\{\forall (n,m) \in \mathbb{Z}^{2}\cap[-N_{lim},N_{lim}], \vec{q}=n\vec{u_x}+m\vec{u_y}\}$ and  rewrite \cref{eq:SMH_FT} as the following:
\begin{equation}
\begin{gathered}
\forall (\nu_x,\nu_y) \in \Gamma, \widetilde{I}_{SMH}(\nu_x,\nu_y)=\frac{1}{p^2}\sum_{n=-N_{lim}}^{n=+N_{lim}}\sum_{m=-N_{lim}}^{m=+N_{lim}}\widetilde{I}_{C}(\nu_x-\frac{n}{p},\nu_y-\frac{m}{p}) \\
\forall \vec{\nu} \in \Gamma, \widetilde{I}_{SMH}(\vec{\nu})=\frac{1}{p^2}\sum_{\vec{q}\in Q_{lim}}\widetilde{I}_{C}(\vec{\nu}-\frac{\vec{q}}{p})
\end{gathered}
\label{eq:SMH_FT_complete}
\end{equation}
\item \underline{Source}: \cite{Pofelski2017}
\item \underline{Ref by}: \cref{DD_1}, \cref{T_1}, \cref{IM_1}, \cref{IM_4}
\end{itemize}
\end{DD}

\subsubsection*{From sampling to interferometry}

Since the Dirac comb function is also periodic, the sampler can also be represented into Fourier series
\begin{equation}
\forall (x,y) \in \mathbb{R}^{2}, S(\vec{r})=\sum_{q\in Q}\delta(\vec{r}-p\vec{q}) = \frac{1}{(2\pi)^2}\sum_{q\in Q}\sum_{l=-\infty}^{l=+\infty}e^{il(\vec{r}-p\vec{q})}
\label{eq:SMH_2}
\end{equation}
Using \cref{eq:SMH_2} in \cref{eq:SMH_simplified_1}, it is possible to recognize an interference equation between multiple plane waves (a more complex version of \cref{eq:hologram}).
\begin{equation}
I_{SMH}(\vec{r})=\frac{1}{(2\pi)^2}\sum_{q\in Q}\sum_{l=-\infty}^{l=+\infty}\sum_{j=-j_{lim}}^{j=+j_{lim}}A_je^{i(\vec{g_j}\cdot\vec{r}+l(\vec{r}-p\vec{q}))+iP_{g_{j}}(\vec{r})}
\label{eq:SMH_3}
\end{equation}

\begin{DD}
\label{DD_3}
\noindent\colorbox{shadecolorDD}{\normalfont \textbf{Deformation gradient tensor from crystalline wave vectors}}
\normalfont
\item \underline{Equation}: \Cref{eq:strain_1}
\item \underline{Description}: Let's consider $\overrightarrow{g_j} = {\overrightarrow{g}_{j}}_{uns} + \Delta \overrightarrow{g}_j$ with ${\overrightarrow{g}_{j}}_{uns}$ representing the crystalline wave vector at its unstrained state. If ${\overrightarrow{g}_{j}}_{uns}={g_{j_{x}}}_{uns}\overrightarrow{u_{x}}+{g_{j_{y}}}_{uns}\overrightarrow{u_{y}}$ and $\Delta \overrightarrow{g_{j}}=\Delta g_{j_{x}}\overrightarrow{u_{x}}+\Delta g_{j_{y}}\overrightarrow{u_{y}}$ are known in the base $\mathcal{B}$ for two non-collinear crystalline wave vectors (only valid for mono-crystalline samples \cref{A_7}), then the strain deformation tensor can be deduced by calculating first both the unstrained matrix $G$ and the variation of the crystalline wave vectors matrix $\Delta G$. Then, under assumptions \cref{A_4} and \cref{A_5}, the deformation gradient tensor $\nabla u$ is estimated as the following with $I_{d}$ representing the identity matrix (see annexe D in \cite{Hytch1998} and equation (30) in \cite{Rouviere2005}). 
\begin{equation}
\begin{gathered}
	G_{uns} =
	\begin{bmatrix}
	{g_{1_{x}}}_{uns} & {g_{1_{y}}}_{uns} \\
	{g_{2_{x}}}_{uns} & {g_{2_{y}}}_{uns} 
	\end{bmatrix} \\
	\Delta G =
	\begin{bmatrix}
	\Delta g_{1_{x}} & \Delta g_{1_{y}} \\
	\Delta g_{2_{x}} & \Delta g_{2_{y}} 
	\end{bmatrix} \\
\nabla u = ({\Delta G}^{T})^{-1}{G_{uns}}^{T}-I_{d}
\end{gathered}
\label{eq:strain_1}
\end{equation}
\item \underline{Source}: \cite{Hytch1998,Rouviere2005}
\item \underline{Ref by}: \cref{T_3}, \cref{DD_1}, \cref{IM_3}, \cref{IM_5}
\end{DD}

\subsubsection{Instance Models} \label{sec_instance}    

\renewcommand{\labelitemi}{$-$}

\begin{IM}
\label{IM_1}
\noindent\colorbox{shadecolorIM}{\normalfont \textbf{Simulate the SMH on a reference to determine $\overrightarrow{q_{j}}$ for each $\overrightarrow{g_j}^{M}$}}
\normalfont
\begin{itemize}
\item \textbf{Input}: $I_{C_{ref}}, p$
\item \textbf{Output}: $\widetilde{I}_{SMH_{sim}}, \overrightarrow{q_{n_j,m_j}}, \overrightarrow{g_j}^{M_{ref}}$
\item \textbf{Description}: Considering that $I_{C_{ref}}$ represents a 2D array of the sample mono-crystalline lattice (\cref{A_6}, \cref{A_7}), the STEM Moir{\'e} hologram with a scanning grid periodicity of $p$ and respecting the assumptions,\cref{A_1}, \cref{A_2}, \cref{A_3}, is simulated to compare it to the experimental STEM Moir{\'e} hologram $I_{SMH_{exp}}$ in Fourier space. Using \cref{DD_2}, the Fourier transform of the simulated STEM Moir{\'e} $\widetilde{I}_{SMH_{sim}}$ hologram is calculated using \cref{eq:SMH_FT_complete}:
\begin{equation}
\forall \vec{\nu} \in \Gamma, \widetilde{I}_{SMH_{sim}}(\vec{\nu})=\frac{1}{p^2}\sum_{\vec{q}\in Q_{lim}}\widetilde{I}_{C_{ref}}(\vec{\nu}-\frac{\vec{q}}{p})
\end{equation}
$N_{lim}$ in $Q_{lim}$ is set with respect to the highest spatial frequency resolved in  $I_{C_{ref}}$ such that $\forall j \in [-j_{lim},j_{lim}], \ \mathcal{C}(\max(||\overrightarrow{g_j}^{C_{ref}}||)\times p) = N_{lim}$ where $\mathcal{C}$ is the ceiling function.
\item \textbf{Source}: \cite{Pofelski2017}
\item \textbf{Ref by}: \cref{IM_4}, \cref{IM_5}, \cref{DD_2}
\end{itemize}
\end{IM}

\subsubsection*{Details on the extraction of $\overrightarrow{q_{n_j,m_j}}$ and $ \overrightarrow{g_j}^{M_{ref}}$}

\begin{IM}
\label{IM_2}
\noindent\colorbox{shadecolorIM}{\normalfont \textbf{GPA on a selected Moir{\'e} wave vector from $I_{SMH_{exp}}$}}
\normalfont
\begin{itemize}
\item \textbf{Input}: $I_{SMH_{exp}}, M_j$
\item \textbf{Output}: $P_{\Delta \overrightarrow{g_{j}}^{M_{exp}}}, \overrightarrow{g_{j}}^{M_{exp}}, \Delta \overrightarrow{g_{j}}^{M_{exp}}$
\item \textbf{Description}: Applying \cref{T_2}, \cref{DD_1} and using assumption \cref{A_1}, $I_{SMH_{exp}}$ can be interpreted as follows
\begin{equation}
\forall \vec{r} \in \mathbb{I},\ I_{SMH_{exp}}=\sum_{j=-j_{lim}}^{j=+j_{lim}}A_je^{i(\overrightarrow{g_{j}}^{M_{exp}}\cdot\vec{r}+P_{\Delta \overrightarrow{g_{j}}^{M_{exp}}})}
\end{equation}
Applying GPA under the assumptions \cref{A_4} and \cref{A_5}, $P_{\Delta \overrightarrow{g_{j}}^{M_{exp}}}$ is extracted using a mask $M_j$ centred around $({g_{j_x}}^{M_{exp}},{g_{j_y}}^{M_{exp}})$ such that
\begin{equation}
\begin{gathered}
\forall \nu \in \Gamma, M_j(\nu) = 
\begin{cases}
1 & \text{for} \ ||\vec{\nu}-\overrightarrow{g_{j}}^{M_{exp}}||\leq\epsilon \ / \ \forall \ l\neq j, \ ||\vec{\nu}-\overrightarrow{g_{l}}^{M_{exp}}||\geq \epsilon \\
0
\end{cases}
\end{gathered}
\end{equation}
Finally considering $M_j\widetilde{I}_{SMH_{exp}}$ the masked Fourier transform of $I_{SMH_{exp}}$,
\begin{equation}
\forall \vec{r} \in \mathbb{I},\ P_{\Delta \overrightarrow{g_{j}}^{M_{exp}}}(\vec{r})=arg(\mathcal{FT}^{-1}[M_j\widetilde{I}_{SMH_{exp}}])(\vec{r})
\end{equation}
Finally the gradient of the $P_{\Delta \overrightarrow{g_{j}}^{M_{exp}}}(\vec{r})$ is calculated to extract ${\Delta \overrightarrow{g_{j}}^{M_{exp}}}(\vec{r})$.
\begin{equation}
\forall \vec{r} \in \mathbb{I},\ \nabla P_{\Delta \overrightarrow{g_{j}}^{M_{exp}}}(\vec{r})=2\pi\Delta \overrightarrow{g_{j}}^{M_{exp}}(\vec{r})
\end{equation}
\item \textbf{Source}: \cite{Hytch1998}
\item \textbf{Ref by}: \cref{IM_3}, \cref{IM_5}, \cref{DD_1}, \cref{T_2}, \cref{DD_2}
\end{itemize}
\end{IM}

\begin{IM}
\label{IM_3}
\noindent\colorbox{shadecolorIM}{\normalfont \textbf{Determine an unstrained area in the geometric phase image}}
\normalfont
\begin{itemize}
\item \textbf{Input}: $\Delta \overrightarrow{g_{j}}^{M_{exp}},U,p$
\item \textbf{Output}: $\overrightarrow{g_{j}}_{uns}^{M_{exp}}$
\item \textbf{Description}: From \cref{DD_1} and \cref{IM_2}, $\forall \vec{r} \in \mathbb{I},\  \nabla P_{\Delta \overrightarrow{g_{j}}^{M_{exp}}} (\vec{r}) = 2\pi \Delta \overrightarrow{g_{j}}^{M_{exp}}(\vec{r})$. An area $U \in \mathbb{I}$ of $\Delta \overrightarrow{g_{j}}^{M_{exp}}$ is set by the user as an unstrained reference, so $\Delta \overrightarrow{g_{j}}^{M_{exp}}$ is set to $\overrightarrow{0}$ in $U$. The operation can be formalized as follows with $card(U)$ representing the cardinality of the set $U$.
\begin{equation}
\forall \vec{r} \in U, \ \overrightarrow{g_{j}}^{M_{exp}}=\frac{1}{card(U)\times p^2}\sum_{\vec{r}\in U}\overrightarrow{g_{j}}_{uns}^{M_{exp}}(\vec{r})
\end{equation}
\item \textbf{Source}: \cite{Hytch1998}
\item \textbf{Ref by}: \cref{IM_2}, \cref{DD_1}, \cref{DD_3}
\end{itemize}
\end{IM}

\begin{IM}
\label{IM_4}
\noindent\colorbox{shadecolorIM}{\normalfont \textbf{Convert the Moir{\'e} wave vector into the Crystalline wave vector}}
\normalfont
\begin{itemize}
\item \textbf{Input}: $\overrightarrow{g_{j}}_{uns}^{M_{exp}},\Delta \overrightarrow{g_{j}}^{M_{exp}},\overrightarrow{q_{n_j,m_j}},p$
\item \textbf{Output}: $\Delta \overrightarrow{g_{j}}^{C_{exp}},\overrightarrow{g_{j}}_{uns}^{C_{exp}}$
\item \textbf{Description}: The conversion is a basic affine vectorial transformation and is highlighted in \cref{eq:conversion_Moire}
\begin{equation}
\label{eq:conversion_Moire}
\begin{gathered}
\begin{cases}
\overrightarrow{g_{j}}_{uns}^{C_{exp}}= \overrightarrow{g_{j}}_{uns}^{M_{exp}} + p \times \overrightarrow{q_{n_j,m_j}} \\
\Delta \overrightarrow{g_{j}}^{C_{exp}}= \Delta \overrightarrow{g_{j}}^{M_{exp}} + p \times \overrightarrow{q_{n_j,m_j}}
\end{cases}
\end{gathered}
\end{equation}
\item \textbf{Source}: \cite{Pofelski2017}
\item \textbf{Ref by}: \cref{IM_1}, \cref{IM_2}, \cref{IM_3}, \cref{DD_2}, \cref{DD_3}, \cref{DD_1}
\end{itemize}
\end{IM}

\begin{IM}
\label{IM_5}
\noindent\colorbox{shadecolorIM}{\normalfont \textbf{Strain calculation using 2 non-crystalline wave vectors}}
\normalfont
\begin{itemize}
\item \textbf{Input}: $g_{1_{{uns}_x}}^{C_{exp}}, g_{1_{{uns}_y}}^{C_{exp}},g_{2_{{uns}_x}}^{C_{exp}}, g_{2_{{uns}_y}}^{C_{exp}}, \Delta g_{1_{x}}^{C_{exp}}, \Delta g_{1_{y}}^{C_{exp}},\Delta g_{2_{x}}^{C_{exp}},\Delta g_{2_{y}}^{C_{exp}}$
\item \textbf{Output}: $\varepsilon_{xx},\varepsilon_{xy},\varepsilon_{yy},\omega_{xy}$, $I_{\varepsilon_{xx}},I_{\varepsilon_{xy}},I_{\varepsilon_{yy}},I_{\omega_{xy}}$
\item \textbf{Description}: Applying \cref{DD_3} and \cref{T_3}, the matrices $G_{uns}$ and $\Delta G$ are formed to calculate the deformation gradient tensor $\nabla u$ and then the rotation $\omega$ and strain $\varepsilon$ tensors on each pixel. The data is then displayed in form of 2D arrays.
\item \textbf{Source}: \cite{Hytch1998,Rouviere2005}
\item \textbf{Ref by}: \cref{IM_4}, \cref{DD_3}, \cref{T_3}
\end{itemize}
\end{IM}

\subsubsection{Data Constraints} \label{sec_DataConstraints}

\begin{DC}
\label{DC_1}
\normalfont U should be the same in both $\Delta \overrightarrow{g_{j}}^{M_{exp}}$ with $j=\{1,2\}$ in \cref{IM_3}.
\end{DC}    
\begin{DC}
\label{DC_2}
\normalfont The pixel size $p$ should be strictly positive ($p>0$).
\end{DC}
\begin{DC}
\label{DC_3}
\normalfont Both $I_{C_{ref}}$ and $I_{SMH_{exp}}$ can be and dm3 file.
\end{DC}

\subsubsection{Properties of a Correct Solution} \label{sec_CorrectSolution}

\noindent
The correctness of the solution must be judged by the user him/herself based on the knowledge of the sample analysed.

\section{Requirements}

This section provides the functional requirements, the tasks that the
software is expected to complete, and the nonfunctional requirements, the
qualities that the software is expected to exhibit.

\subsection{Functional Requirements}

\begin{R}
\label{R_1}
\normalfont Provide an environment for the user to input ${I_{SMF}}$ and $I_{C_{ref}}$.
\end{R}
\begin{R}
\label{R_2}
\normalfont Verify the format of the inputs ${I_{SMF}}$ and $I_{C_{ref}}$.
\end{R}
\begin{R}
\label{R_3}
\normalfont Output $\widetilde{I}_{SMH_{exp}}$.
\end{R}
\begin{R}
\label{R_4}
\normalfont Display to the user $\widetilde{I}_{SMH_{exp}}$ and $\widetilde{I}_{SMH_{sim}}$ to allow the user to determine $\overrightarrow{q_{n_j,m_j}}$ for each $\overrightarrow{g_j}^{M_{ref}}$.
\end{R}
\begin{R}
\label{R_5}
\normalfont Provide an environment for the user to input $M_j$ for each $\overrightarrow{g_{j}}^{M_{exp}}$ with $j=\{1,2\}$ on $\widetilde{I}_{SMH_{exp}}$.
\end{R}
\begin{R}
\label{R_6}
\normalfont Verify both $M_j$ inputs with $j=\{1,2\}$.
\end{R}
\begin{R}
\label{R_7}
\normalfont Output both $P_{\Delta \overrightarrow{g_{j}}^{M_{exp}}}$ and $\overrightarrow{g_{j}}^{M_{exp}}$ with $j=\{1,2\}$.
\end{R}
\begin{R}
\label{R_8}
\normalfont Display both $\Delta \overrightarrow{g_{j}}^{M_{exp}}$  with $j=\{1,2\}$ and provide an environment for the user to input $U$.
\end{R}
\begin{R}
\label{R_9}
\normalfont Verify the input $U$.
\end{R}
\begin{R}
\label{R_10}
\normalfont Output both $\overrightarrow{g_{j}}_{uns}^{M_{exp}}$ with $j=\{1,2\}$.
\end{R}
\begin{R}
\label{R_11}
\normalfont Provide an environment to the user to input both $\overrightarrow{q_{n_j,m_j}}$ with $j=\{1,2\}$.
\end{R}
\begin{R}
\label{R_12}
\normalfont Output both  $\Delta \overrightarrow{g_{j}}^{C_{exp}}$ and both $\overrightarrow{g_{j}}_{uns}^{C_{exp}}$ with $j=\{1,2\}$.
\end{R}
\begin{R}
\label{R_13}
\normalfont Output $\varepsilon_{xx},\varepsilon_{xy},\varepsilon_{yy},\omega_{xy}$ on each element of the array to form $I_{\varepsilon_{xx}},I_{\varepsilon_{xy}},I_{\varepsilon_{yy}},I_{\omega_{xy}}$.
\end{R}
\begin{R}
\label{R_14}
\normalfont Display to the user $I_{\varepsilon_{xx}},I_{\varepsilon_{xy}},I_{\varepsilon_{yy}},I_{\omega_{xy}}$.
\end{R}

\subsection{Nonfunctional Requirements}

\wss{List your nonfunctional requirements.  You may consider using a fit
  criterion to make them verifiable.}

\begin{NR}
\label{NR_1} 
\normalfont The software shall be reproducible on the most used operating systems (Linux, Mac, Windows).
\end{NR}

\begin{NR}
\label{NR_2} 
\normalfont The software shall run on a classic PC desktop.
\end{NR}

\begin{NR}
\label{NR_3} 
\normalfont The data display shall be readable by the user (standard font, standard font size, standard organisation of display, standard colors).
\end{NR}

\begin{NR}
\label{NR_4} 
\normalfont All the environments expecting an input from the user shall be accessible and executable quickly (in a few seconds time frame).
\end{NR}

\begin{NR}
\label{NR_5} 
\normalfont The user shall be able to extract the final data in text or csv format.
\end{NR}

\begin{NR}
\label{NR_6} 
\normalfont The \progname{} software shall be able to save the information processed in a temporary file (or cache file) to prevent a loss of information when the software or the PC crashes.
\end{NR}

\begin{NR}
\label{NR_7} 
\normalfont When starting the \progname{} software, the existence of a temporary file should be checked and the user should be asked if he or she wants to start the software from the previously saved temporary file.
\end{NR}

\begin{NR}
\label{NR_8} 
\normalfont The precision on the final results from \progname{} software should be limited only by the quality of the initial $SMH_{exp}$ and by the user inputs.
\end{NR}

\begin{NR}
\label{NR_9} 
\normalfont The inaccuracy of the \progname{} software should not be greater than the precision detailed in \cref{NR_8}.
\end{NR}


\section{Likely Changes}    

For the moment, no element has been identify to be subjected to a change however, it is possible that a solution improving in the accuracy and the precision of the \progname{} software is found in the next phases of the development. If the solution is not affecting drastically the skeleton of the software, the solution will be implemented.

\section{Traceability Matrices and Graphs}


\afterpage{
%\begin{landscape}
\begin{table}[H]
\label{table:Matrix_1}
\centering
\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|c|}
\hline
	& \cref{T_1} & \cref{T_2} & \cref{T_3} & \cref{DD_1} & \cref{DD_2} & \cref{DD_3} & \cref{IM_1} & \cref{IM_2} & \cref{IM_3} & \cref{IM_4} & \cref{IM_5} \\
\hline
\cref{T_1}			& \cellcolor{gray!25} & & & & & & & & & & \\ \hline
\cref{T_2}			& & \cellcolor{gray!25} & & & & & & & & & \\ \hline
\cref{T_3}			& & & \cellcolor{gray!25} & & & & & & & & \\ \hline
\cref{DD_1}			& & X & & \cellcolor{gray!25} & & & & & & & \\ \hline
\cref{DD_2}			& X & & & X & \cellcolor{gray!25} & & & & & & \\ \hline
\cref{DD_3}			& & & & X & & \cellcolor{gray!25} & & & & & \\ \hline
\cref{IM_1}			& X & & & X & X & & \cellcolor{gray!25} & & & & \\ \hline
\cref{IM_2}			& & X & & X & X & & X & \cellcolor{gray!25} & & & \\ \hline
\cref{IM_3}			& & & X & X & & X & & X & \cellcolor{gray!25} & & \\ \hline
\cref{IM_4}			& X & & & X & X & & X & & X & \cellcolor{gray!25} & \\ \hline
\cref{IM_5}			& & & X & X & & X & & & & X & \cellcolor{gray!25} \\ \hline
\end{tabular}
\caption{Traceability Matrix for the theoertical models TM, the data definitions DD and the instance models IM}
\end{table}
%\end{landscape}
}

\afterpage{
%\begin{landscape}
\begin{table}[H]
\label{table:Matrix_2}
\centering
\begin{tabular}{|c|c|c|c|c|c|c|c|}
\hline
	& \cref{A_1} & \cref{A_2} & \cref{A_3} & \cref{A_4} & \cref{A_5} & \cref{A_6} & \cref{A_7} \\
\hline
\cref{T_1}			& & & & & & & \\ \hline
\cref{T_2}			& & & & & & & \\ \hline
\cref{T_3}			& & & & X & X & & \\ \hline
\cref{DD_1}			& & & & X & X & & X \\ \hline
\cref{DD_2}			& X & X & X & & & & \\ \hline
\cref{DD_3}			& & & & X & X & & X \\ \hline
\cref{IM_1}			& X & X & X & & & X & X \\ \hline
\cref{IM_2}			& X & & & X & X & & \\ \hline
\cref{IM_3}			& & & & & & & \\ \hline
\cref{IM_4}			& & & & & & & \\ \hline
\cref{IM_5}			& & & & X & X & & \\ \hline
\end{tabular}
\caption{Traceability Matrix linking the assumptions to the theoertical models TM, the data definitions DD and the instance models IM}
\end{table}
%\end{landscape}
}

\afterpage{
\begin{landscape}
\begin{table}[H]
\label{table:Matrix_3}
\centering
\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|}
\hline
	& \cref{IM_1} & \cref{IM_2} & \cref{IM_3} & \cref{IM_4} & \cref{IM_5} & \cref{R_1} & \cref{R_2} & \cref{R_3} & \cref{R_4} & \cref{R_5} & \cref{R_6} & \cref{R_7} & \cref{R_8} & \cref{R_9} & \cref{R_10} & \cref{R_11} & \cref{R_12} & \cref{R_13} & \cref{R_14} \\
\hline
\cref{IM_1}			& \cellcolor{gray!25}& & & & & X & & & & & & & & & & & & & \\ \hline
\cref{IM_2}			& X &\cellcolor{gray!25} & & & & X & & X & & X & & & & & & & & & \\ \hline
\cref{IM_3}			& & X &\cellcolor{gray!25} & & & & & & & & & & X & & & & & & \\ \hline
\cref{IM_4}			& X & & X &\cellcolor{gray!25} & & X & & & X & & & & & & & X & & & \\ \hline
\cref{IM_5}			& & & & X &\cellcolor{gray!25} & & & & & & & & & & & & & & \\ \hline
\cref{R_1}			& X & X & & & &\cellcolor{gray!25} & & & & & & & & & & & & & \\ \hline
\cref{R_2}			& X & & & & & &\cellcolor{gray!25} & & & & & & & & & & & & \\ \hline
\cref{R_3}			& X & & & & & & &\cellcolor{gray!25} & & & & & & & & & & & \\ \hline
\cref{R_4}			& X & & & & & & & &\cellcolor{gray!25} & & & & & & & & & & \\ \hline
\cref{R_5}			& & & & & & & & & &\cellcolor{gray!25} & & & & & & & & & \\ \hline
\cref{R_6}			& & & & & & & & & & &\cellcolor{gray!25} & & & & & & & & \\ \hline
\cref{R_7}			& & & & & & & & & & & &\cellcolor{gray!25} & & & & & & & \\ \hline
\cref{R_8}			& & & & & & & & & & & & &\cellcolor{gray!25} & & & & & & \\ \hline
\cref{R_9}			& & & & & & & & & & & & & &\cellcolor{gray!25} & & & & & \\ \hline
\cref{R_10}			& & & & & & & & & & & & & & &\cellcolor{gray!25} & & & & \\ \hline
\cref{R_11}			& X & & & & & & & & & & & & & & &\cellcolor{gray!25} & & & \\ \hline
\cref{R_12}			& & & & & & & & & & & & & & & & &\cellcolor{gray!25} & & \\ \hline
\cref{R_13}			& & & & & & & & & & & & & & & & & &\cellcolor{gray!25} & \\ \hline
\cref{R_14}			& & & & & & & & & & & & & & & & & & &\cellcolor{gray!25} \\ \hline

\end{tabular}
\caption{Traceability Matrix for the instance models IM and the requirements R}
\end{table}
\end{landscape}
}

\newpage

\bibliography{SRS_biblio}
\bibliographystyle{ieeetr}


\newpage

\section{Appendix}

\wss{Your report may require an appendix.  For instance, this is a good point to
show the values of the symbolic parameters introduced in the report.}

\subsection{Symbolic Parameters}



\end{document}
